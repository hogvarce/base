function addParamUrl(e,a){var o=window.location.href,t=new RegExp("[?|&]"+e+"=[0-9a-zA-Z_+-|.,;]*");if(t.test(o)){var t=new RegExp("[?&]"+e+"=([^&#]*)"),n=t.exec(o)[0].charAt(0);o=o.replace(t,n+e+"="+a)}else{var i=e+"="+a;if(o.indexOf("?")&&(o+="?"),o.indexOf("#")>-1){var p=o.split("#");o=p[0]+"&"+i+(p[1]?"#"+p[1]:"")}else o+="&"+i}window.history.pushState(null,document.title,o),location.href=o}var app=app||{};app.singleGood=Backbone.Model.extend({defaults:{pagetitle:"undefined",price:0,image:"/img/no_photo.png",count:1}});var app=app||{};app.allGoodsViews=Backbone.View.extend({tagName:"ul",className:"row list-inline",render:function(){return this.collection.each(this.addGood,this),this},addGood:function(e){var a=new app.singleGoodView({model:e}),o=Math.random();a.$el.attr("data-wow-delay",o+"s"),this.$el.append(a.render().el)}});var app=app||{};app.singleGoodView=Backbone.View.extend({tagName:"li",className:"col-xs-12 col-sm-6 col-md-4 col-lg-4 good wow animate zoomIn",template:_.template($("#Good").html()||""),render:function(){var e=this.template(this.model.toJSON());return this.$el.html(e),this},events:{"change .buy + input":function(e){this.model.set("count",$(e.target).val())},"click img.good-preview":"openFrame"},openFrame:function(){var e=this.$(".description").html();$.fancybox({content:e})}});var app=app||{};app.GoodsCollections=Backbone.Collection.extend({model:app.singleGood});var app=app||{};if(app.Router=Backbone.Router.extend({routes:{},initialize:function(){var e=parseInt($.url().param("pagin"),10)||1,a=parseInt($.url().param("category"),10)||0,o=new app.GoodsCollections;if(0!=a){var t="parent IN (SELECT id FROM goods_category WHERE id='"+a+"')";o.url='/api/goods?filter="'+t+'"&page='+e}else o.url="/api/goods?page="+e;o.fetch({success:function(e,o,t){for(var n=new app.allGoodsViews({collection:e}),i=t.xhr.getResponseHeader("X-Pagination-Page-Count"),p=t.xhr.getResponseHeader("X-Pagination-Current-Page"),r='<div class="pagination">',s="",l=1;i>=l;l++)s=p==l?'class="pagin active"':'class="pagin"',r+="<a "+s+'href="?pagin='+l+"&category="+a+'"><span>'+l+"</span></a>";r+="</div>",$(".goods").append(n.render().el).before(r).after(r)}})}}),$(".goods").length){var goodsRoute=new app.Router;Backbone.history.start({pushState:!0})}$(function(){(new WOW).init(),$(".navigation .nav a").each(function(e){var a=$(this).attr("href");location.pathname==a&&$(this).parent().addClass("active")}),$(".navigation, .side-menu").tmStickUp()}());